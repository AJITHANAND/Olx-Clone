import{r as o,j as l}from"./react-40402f93.js";import{c as B,s as U,o as be,a as O,l as H,b as P}from"./dom-helpers-29a8c434.js";import{R as pe}from"./react-dom-8f3747d7.js";const _=e=>!e||typeof e=="function"?e:t=>{e.current=t};function ye(e,t){const n=_(e),r=_(t);return s=>{n&&n(s),r&&r(s)}}function z(e,t){return o.useMemo(()=>ye(e,t),[e,t])}function xe(e){const t=o.useRef(e);return o.useEffect(()=>{t.current=e},[e]),t}function m(e){const t=xe(e);return o.useCallback(function(...n){return t.current&&t.current(...n)},[t])}function Xe(){return o.useState(null)}function we(){const e=o.useRef(!0),t=o.useRef(()=>e.current);return o.useEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),t.current}function Me(e){const t=o.useRef(null);return o.useEffect(()=>{t.current=e}),t.current}const ke=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",Te=typeof document<"u",V=Te||ke?o.useLayoutEffect:o.useEffect;function Oe(e){const t=o.useRef(e);return t.current=e,t}function Ce(e){const t=Oe(e);o.useEffect(()=>()=>t.current(),[])}const je="data-rr-ui-";function Be(e){return`${je}${e}`}const G=o.createContext(B?window:void 0);G.Provider;function D(){return o.useContext(G)}function De(e=document){const t=e.defaultView;return Math.abs(t.innerWidth-e.documentElement.clientWidth)}const X=Be("modal-open");class Fe{constructor({ownerDocument:t,handleContainerOverflow:n=!0,isRTL:r=!1}={}){this.handleContainerOverflow=n,this.isRTL=r,this.modals=[],this.ownerDocument=t}getScrollbarWidth(){return De(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(t){}removeModalAttributes(t){}setContainerStyle(t){const n={overflow:"hidden"},r=this.isRTL?"paddingLeft":"paddingRight",s=this.getElement();t.style={overflow:s.style.overflow,[r]:s.style[r]},t.scrollBarWidth&&(n[r]=`${parseInt(U(s,r)||"0",10)+t.scrollBarWidth}px`),s.setAttribute(X,""),U(s,n)}reset(){[...this.modals].forEach(t=>this.remove(t))}removeContainerStyle(t){const n=this.getElement();n.removeAttribute(X),Object.assign(n.style,t.style)}add(t){let n=this.modals.indexOf(t);return n!==-1||(n=this.modals.length,this.modals.push(t),this.setModalAttributes(t),n!==0)||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),n}remove(t){const n=this.modals.indexOf(t);n!==-1&&(this.modals.splice(n,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(t))}isTopModal(t){return!!this.modals.length&&this.modals[this.modals.length-1]===t}}const J=Fe,C=(e,t)=>B?e==null?(t||be()).body:(typeof e=="function"&&(e=e()),e&&"current"in e&&(e=e.current),e&&("nodeType"in e||e.getBoundingClientRect)?e:null):null;function Se(e,t){const n=D(),[r,s]=o.useState(()=>C(e,n==null?void 0:n.document));if(!r){const i=C(e);i&&s(i)}return o.useEffect(()=>{t&&r&&t(r)},[t,r]),o.useEffect(()=>{const i=C(e);i!==r&&s(i)},[e,r]),r}function We({children:e,in:t,onExited:n,mountOnEnter:r,unmountOnExit:s}){const i=o.useRef(null),d=o.useRef(t),f=m(n);o.useEffect(()=>{t?d.current=!0:f(i.current)},[t,f]);const g=z(i,e.ref),a=o.cloneElement(e,{ref:g});return t?a:s||!d.current&&r?null:a}function Ae({in:e,onTransition:t}){const n=o.useRef(null),r=o.useRef(!0),s=m(t);return V(()=>{if(!n.current)return;let i=!1;return s({in:e,element:n.current,initial:r.current,isStale:()=>i}),()=>{i=!0}},[e,s]),V(()=>(r.current=!1,()=>{r.current=!0}),[]),n}function Ie({children:e,in:t,onExited:n,onEntered:r,transition:s}){const[i,d]=o.useState(!t);t&&i&&d(!1);const f=Ae({in:!!t,onTransition:a=>{const E=()=>{a.isStale()||(a.in?r==null||r(a.element,a.initial):(d(!0),n==null||n(a.element)))};Promise.resolve(s(a)).then(E,p=>{throw a.in||d(!0),p})}}),g=z(f,e.ref);return i&&!t?null:o.cloneElement(e,{ref:g})}function q(e,t,n){return e?l.jsx(e,Object.assign({},n)):t?l.jsx(Ie,Object.assign({},n,{transition:t})):l.jsx(We,Object.assign({},n))}function Le(e){return e.code==="Escape"||e.keyCode===27}const Ne=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];function Ke(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,i;for(i=0;i<r.length;i++)s=r[i],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}let j;function Ue(e){return j||(j=new J({ownerDocument:e==null?void 0:e.document})),j}function He(e){const t=D(),n=e||Ue(t),r=o.useRef({dialog:null,backdrop:null});return Object.assign(r.current,{add:()=>n.add(r.current),remove:()=>n.remove(r.current),isTopModal:()=>n.isTopModal(r.current),setDialogRef:o.useCallback(s=>{r.current.dialog=s},[]),setBackdropRef:o.useCallback(s=>{r.current.backdrop=s},[])})}const Q=o.forwardRef((e,t)=>{let{show:n=!1,role:r="dialog",className:s,style:i,children:d,backdrop:f=!0,keyboard:g=!0,onBackdropClick:a,onEscapeKeyDown:E,transition:p,runTransition:Y,backdropTransition:Z,runBackdropTransition:$,autoFocus:ee=!0,enforceFocus:te=!0,restoreFocus:ne=!0,restoreFocusOptions:re,renderDialog:F,renderBackdrop:oe=u=>l.jsx("div",Object.assign({},u)),manager:se,container:ie,onShow:S,onHide:W=()=>{},onExit:ue,onExited:A,onExiting:ce,onEnter:ae,onEntering:le,onEntered:de}=e,fe=Ke(e,Ne);const h=D(),v=Se(ie),c=He(se),me=we(),he=Me(n),[y,I]=o.useState(!n),R=o.useRef(null);o.useImperativeHandle(t,()=>c,[c]),B&&!he&&n&&(R.current=O(h==null?void 0:h.document)),n&&y&&I(!1);const L=m(()=>{if(c.add(),M.current=H(document,"keydown",ve),w.current=H(document,"focus",()=>setTimeout(ge),!0),S&&S(),ee){var u,K;const T=O((u=(K=c.dialog)==null?void 0:K.ownerDocument)!=null?u:h==null?void 0:h.document);c.dialog&&T&&!P(c.dialog,T)&&(R.current=T,c.dialog.focus())}}),x=m(()=>{if(c.remove(),M.current==null||M.current(),w.current==null||w.current(),ne){var u;(u=R.current)==null||u.focus==null||u.focus(re),R.current=null}});o.useEffect(()=>{!n||!v||L()},[n,v,L]),o.useEffect(()=>{y&&x()},[y,x]),Ce(()=>{x()});const ge=m(()=>{if(!te||!me()||!c.isTopModal())return;const u=O(h==null?void 0:h.document);c.dialog&&u&&!P(c.dialog,u)&&c.dialog.focus()}),Ee=m(u=>{u.target===u.currentTarget&&(a==null||a(u),f===!0&&W())}),ve=m(u=>{g&&Le(u)&&c.isTopModal()&&(E==null||E(u),u.defaultPrevented||W())}),w=o.useRef(),M=o.useRef(),Re=(...u)=>{I(!0),A==null||A(...u)};if(!v)return null;const N=Object.assign({role:r,ref:c.setDialogRef,"aria-modal":r==="dialog"?!0:void 0},fe,{style:i,className:s,tabIndex:-1});let k=F?F(N):l.jsx("div",Object.assign({},N,{children:o.cloneElement(d,{role:"document"})}));k=q(p,Y,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!n,onExit:ue,onExiting:ce,onExited:Re,onEnter:ae,onEntering:le,onEntered:de,children:k});let b=null;return f&&(b=oe({ref:c.setBackdropRef,onClick:Ee}),b=q(Z,$,{in:!!n,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:b})),l.jsx(l.Fragment,{children:pe.createPortal(l.jsxs(l.Fragment,{children:[b,k]}),v)})});Q.displayName="Modal";const qe=Object.assign(Q,{Manager:J});export{qe as B,J as M,m as a,Xe as b,Ce as c,z as u};
